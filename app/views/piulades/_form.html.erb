<%= form_with model: @piulade, data: { controller: "reset-form", action: "turbo:submit-end->reset-form#reset" } do |form|  %>
  <% if flash[:piulade_errors] %>
    <div class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-lg mt-3 mx-3">
      <ul>
        <% flash[:piulade_errors].each do |error| %>
          <li><%= error %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <%= form.text_area :body, class: "border-b border-t-0 border-x-0 mb-6 px-6 pt-6 block w-full border-gray-200 focus:shadow-none focus:outline-hidden focus:ring-transparent focus:border-gray-300 resize-none min-h-[180px] text-lg", placeholder: "En que penses?" %>

  <div class="field px-6 mb-4" data-controller="file-validation"
       data-file-validation-max-size-value="3145728"
       data-file-validation-max-files-value="4"
       data-file-validation-allowed-types-value='["image/jpeg", "image/jpg", "image/png", "image/gif", "image/webp"]'
       data-file-validation-allowed-extensions-value='[".jpg", ".jpeg", ".png", ".gif", ".webp"]'>
    <%= form.label :files, "Puja imatges (màxim 4)", class: "block text-sm font-medium text-gray-700 mb-2" %>
    <span class="text-xs text-gray-500 block mb-2">Formats permesos: JPG, PNG, GIF, WebP. Mida màxima per fitxer: 3MB</span>
    <%= form.file_field :files, multiple: true,
                        data: {
                          "file-validation-target": "input",
                          action: "change->file-validation#validate"
                        },
                        accept: "image/jpeg,image/jpg,image/png,image/gif,image/webp",
                        class: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" %>
    <div data-file-validation-target="error" class="hidden"></div>
    <div data-file-validation-target="preview" class="mt-2 flex flex-wrap"></div>
  </div>

  <div class="flex justify-end px-6 -mt-4">
    <%= form.submit 'Piula', class: 'btn-sm' %>
  </div>
<% end %>
